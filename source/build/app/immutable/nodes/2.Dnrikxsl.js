import{a as O,t as D,d as we}from"../chunks/disclose-version.I67LwOvb.js";import{W as me,w as Ee,A as m,_ as X,$ as Ne,i as Ae,ac as de,af as Te,ag as ne,a7 as K,C as z,ap as H,ah as ve,x as pe,ai as Ie,e as ae,aq as Re,ar as Me,as as Pe,v as Oe,s as ie,at as ze,au as Le,ab as Se,av as Ce,z as Ve,X as De,a8 as Fe,a2 as We,a5 as Ue,h as le,aw as He,D as G,ao as W,I as Je,O as Q,G as B,c as w,d as x,q as Ge,Q as k,T as U,V as L,ax as Be,F as Y}from"../chunks/runtime.-LiS_To0.js";import{p as ue,a as M}from"../chunks/props.C1vGAg5u.js";import{d as Ye,a as $}from"../chunks/store.DMN06xn4.js";let j=null;function Ze(s,e){return e}function qe(s,e,r,a){for(var l=[],u=e.length,o=0;o<u;o++)Le(e[o].e,l,!0);var h=u>0&&l.length===0&&r!==null;if(h){var _=r.parentNode;Se(_),_.append(r),a.clear(),A(s,e[0].prev,e[u-1].next)}Ce(l,()=>{for(var v=0;v<u;v++){var n=e[v];h||(a.delete(n.k),A(s,n.prev,n.next)),Ve(n.e,!h)}})}function Xe(s,e,r,a,l,u=null){var o=s,h={flags:e,items:new Map,first:null};{var _=s;o=m?X(De(_)):_.appendChild(me())}m&&Ne();var v=null,n=!1;Ee(()=>{var t=r(),i=Ae(t)?t:t==null?[]:de(t),c=i.length;if(n&&c===0)return;n=c===0;let f=!1;if(m){var y=o.data===Te;y!==(c===0)&&(o=ne(),X(o),K(!1),f=!0)}if(m){for(var g=null,p,d=0;d<c;d++){if(z.nodeType===8&&z.data===Fe){o=z,f=!0,K(!1);break}var T=i[d],N=a(T,d);p=ge(z,h,g,null,T,N,d,l,e),h.items.set(N,p),g=p}c>0&&X(ne())}if(!m){var b=We;Ke(i,h,o,l,e,(b.f&H)!==0,a)}u!==null&&(c===0?v?ve(v):v=pe(()=>u(o)):v!==null&&Ie(v,()=>{v=null})),f&&K(!0),r()}),m&&(o=z)}function Ke(s,e,r,a,l,u,o){var h=s.length,_=e.items,v=e.first,n=v,t,i=null,c=[],f=[],y,g,p,d;for(d=0;d<h;d+=1){if(y=s[d],g=o(y,d),p=_.get(g),p===void 0){var T=n?n.e.nodes_start:r;i=ge(T,e,i,i===null?e.first:i.next,y,g,d,a,l),_.set(g,i),c=[],f=[],n=i.next;continue}if(Qe(p,y,d),p.e.f&H&&ve(p.e),p!==n){if(t!==void 0&&t.has(p)){if(c.length<f.length){var N=f[0],b;i=N.prev;var se=c[0],Z=c[c.length-1];for(b=0;b<c.length;b+=1)oe(c[b],N,r);for(b=0;b<f.length;b+=1)t.delete(f[b]);A(e,se.prev,Z.next),A(e,i,se),A(e,Z,N),n=N,i=Z,d-=1,c=[],f=[]}else t.delete(p),oe(p,n,r),A(e,p.prev,p.next),A(e,p,i===null?e.first:i.next),A(e,i,p),i=p;continue}for(c=[],f=[];n!==null&&n.k!==g;)(u||!(n.e.f&H))&&(t??(t=new Set)).add(n),f.push(n),n=n.next;if(n===null)continue;p=n}c.push(p),i=p,n=p.next}if(n!==null||t!==void 0){for(var q=t===void 0?[]:de(t);n!==null;)(u||!(n.e.f&H))&&q.push(n),n=n.next;var be=q.length;if(be>0){var ke=h===0?r:null;qe(e,q,ke,_)}}ae.first=e.first&&e.first.e,ae.last=i&&i.e}function Qe(s,e,r,a){Re(s.v,e),s.i=r}function ge(s,e,r,a,l,u,o,h,_){var v=j;try{var n=(_&Me)!==0,t=(_&Pe)===0,i=n?t?Oe(l):ie(l):l,c=_&ze?ie(o):o,f={i:c,v:i,k:u,a:null,e:null,prev:r,next:a};return j=f,f.e=pe(()=>h(s,i,c),m),f.e.prev=r&&r.e,f.e.next=a&&a.e,r===null?e.first=f:(r.next=f,r.e.next=f.e),a!==null&&(a.prev=f,a.e.prev=f.e),f}finally{j=v}}function oe(s,e,r){for(var a=s.next?s.next.e.nodes_start:r,l=e?e.e.nodes_start:r,u=s.e.nodes_start;u!==a;){var o=Ue(u);l.before(u),u=o}}function A(s,e,r){e===null?s.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function $e(s,e,r,a){var l=s.__attributes??(s.__attributes={});m&&(l[e]=s.getAttribute(e)),l[e]!==(l[e]=r)&&(r==null?s.removeAttribute(e):typeof r!="string"&&je(s).includes(e)?s[e]=r:s.setAttribute(e,r))}var fe=new Map;function je(s){var e=fe.get(s.nodeName);if(e)return e;fe.set(s.nodeName,e=[]);for(var r,a=le(s),l=Element.prototype;l!==a;){r=He(a);for(var u in r)r[u].set&&e.push(u);a=le(a)}return e}function et(s,e){var r=s.__className,a=tt(e);m&&s.className===a?s.__className=a:(r!==a||m&&s.className!==a)&&(e==null?s.removeAttribute("class"):s.className=a,s.__className=a)}function tt(s){return s??""}function ce(s,e,r){if(r){if(s.classList.contains(e))return;s.classList.add(e)}else{if(!s.classList.contains(e))return;s.classList.remove(e)}}const te="LPAREN",xe="RPAREN",S="PLUS",P="PARALLEL",I="NUMBER",C="TIMES",V="DIVIDE",rt="DONE";class st{get_next_token(){return this.tokens.shift()}constructor(e){this.tokens=e,this.current_token=this.get_next_token()}error(){console.error("Parsing errror",this.current_token)}eat(e){this.current_token.type==e?this.current_token=this.get_next_token():this.error()}factor(){let e=this.current_token;if(e.type==I)return this.eat(I),e;if(e.type==te){this.eat(te);let r=this.expr();return this.eat(xe),r}}term(){let e=this.factor();for(;[P,C,V].includes(this.current_token.type);){let r=this.current_token;r.type==P?this.eat(P):r.type==C?this.eat(C):r.type==V&&this.eat(V),e={left:e,op:r,right:this.factor()}}return e}expr(){let e=this.term();for(;[S].includes(this.current_token.type);){let r=this.current_token;r.type==S&&this.eat(S),e={left:e,op:r,right:this.term()}}return e}parse(){return this.expr()}}function he(s,e){return 1/(1/s+1/e)}const R=[{value:1e-15,symbol:"f",name:"Femto"},{value:1e-12,symbol:"p",name:"Pico"},{value:1e-9,symbol:"n",name:"Nano"},{value:1e-6,symbol:"u",name:"Micro"},{value:.001,symbol:"m",name:"Milli"},{value:1,symbol:"",name:""},{value:1e3,symbol:"k",name:"Kilo"},{value:1e6,symbol:"M",name:"Mega"},{value:1e9,symbol:"G",name:"Giga"},{value:1e12,symbol:"T",name:"Tera"}];function ee(s){let e=parseFloat(s),r="eE";if(r.includes(s))throw new Error("Missing Base");if(r.includes(s.charAt(s.length-1)))throw new Error("Missing Exponent");return R.forEach(a=>{s.charAt(s.length-1).includes(a.symbol)&&(e*=a.value)}),e}function ye(s,e="resistance"){if(s=s+"",s=="")return;let r=[];function a(t){let i;if([["|",P],["(",te],[")",xe],["+",S],["*",C],["/",V]].forEach(f=>{f[0]===t&&(i=f[1])}),i===void 0)throw new Error('"'+t+'" not valid');return i}let l=!1,u="",o="0123456789.-";o+="eE",R.forEach(t=>{o+=t.symbol});for(let t in s){let i=s[t];if(i===" ")continue;let c=o.includes(i);c&&(u+=i),l=u.length>0,!c&&l?(r.push({token:u,type:I}),u="",l=!1,r.push({token:i,type:a(i)})):c||r.push({token:i,type:a(i)})}if(l&&r.push({token:u,type:I}),r.push({type:rt}),r.length==2&&r[0].type==I)return ee(r[0].token);let _=new st(r).parse();function v(t){let i;if(t.left===void 0||t.right===void 0)throw new Error("Incomplete expression");t.left.type==I?i=ee(t.left.token):i=v(t.left);let c;if(t.right.type==I?c=ee(t.right.token):c=v(t.right),t.op.type==P)return e==="resistance"?he(i,c):i+c;if(t.op.type==S)return e==="resistance"?i+c:he(i,c);if(t.op.type==C)return i*c;if(t.op.type==V)return i/c;console.info("You should not be here!",t.op.type,t.op.type==P)}let n="Parsing Error";try{n=v(_)}catch(t){return console.error("PARSING ERROR"),console.log(t),console.log(JSON.stringify(_)),"Parsing error: "+t.message}return n}let nt=[{exp:"(1+1)",assert:2},{exp:"(100+100+100)",assert:300},{exp:"1",assert:1},{exp:"1|1",assert:.5},{exp:"1|1|1|1",assert:.25},{exp:"1|1|1|1+1",assert:1.25},{exp:"1|1|(0.5+1|1)|1+1",assert:1.25},{exp:"1k*2k",assert:1e3*2e3},{exp:"3*7k+1",assert:3*7e3+1},{exp:"2+3*7k+1",assert:2+3*7e3+1},{exp:"2+3*7k+1|1",assert:2+3*7e3+.5},{exp:"(1|1)",assert:.5},{exp:"(1|1)*2",assert:1},{exp:"2*(1|1)",assert:1},{exp:"1+2*(1|1)",assert:2},{exp:"10+2*2+(1|1)",assert:10+2*2+.5},{exp:"7*3",assert:7*3},{exp:"7*3/2",assert:7*3/2},{exp:"7/11*3/2",assert:7/11*3/2},{exp:"7/11*3/2+1",assert:7/11*3/2+1},{exp:"(7/11*3/2+1)/5",assert:(7/11*3/2+1)/5}],F=!0;nt.forEach(s=>{let e=ye(s.exp);e!=s.assert&&(console.error("Test failed!!"),console.log("Test:",JSON.stringify(s),"Result:",e,"Expected",s.assert),F=!1)});F&&console.log("All tests passed!");function J(s){if(isNaN(s))return console.log("Not a number"),s;if(!isFinite(s))return console.log("Infinite number"),s;let e=!1,r=R[0];if(!(s<r.value))for(let l=0;l<R.length;l++){let u=R[l];if(l==R.length-1)break;let o=R[l+1].value;s<o&&!e&&(r=u,e=!0)}let a=s;if(e){a=s/r.value;let l=1e3;return a=Math.round(a*l)/l,a+""+r.symbol}else return parseFloat(a).toPrecision(3)}let _e=[{n:1,assert:"1"},{n:1e3,assert:"1k"},{n:1e6,assert:"1M"},{n:1e9,assert:"1G"},{n:1e12,assert:"1.00e+12"},{n:1e15,assert:"1.00e+15"},{n:13123123123123122e-1,assert:"1.31e+15"},{n:0x4f9494ccaafb3,assert:"1.40e+15"},{n:1/3,assert:"333.333m"},{n:.001,assert:"1m"},{n:1e-6,assert:"1u"},{n:1e-9,assert:"1n"},{n:1e-12,assert:"1p"},{n:1e-15,assert:"1f"},{n:1e-18,assert:"1.00e-18"},{n:1001,assert:"1.001k"},{n:.001,assert:"1m"},{n:1e-6,assert:"1u"},{n:1e-9,assert:"1n"},{n:1e-12,assert:"1p"},{n:1e-15,assert:"1f"},{n:1e-18,assert:"1.00e-18"},{n:13123123123123122e-31,assert:"1.312f"},{n:13999931231231231e-31,assert:"1.4f"},{n:.001/3,assert:"333.333u"}];F=!0;for(let s=0;s<_e.length;s++){let e=_e[s],r=J(e.n);if(r!=e.assert){console.error("Test failed!!"),console.log("Test:",e,"Result:",r,"Expected",e.assert),F=!1;break}}F?console.log("All stringify tests passed!"):console.error("Test failed");function at(s,e,r,a,l,u,o,h,_){w(e,"");let v=s.target.value;if(w(r,M((v===""||v===void 0)&&!x(a))),x(r)){l(void 0),w(u,!1),o(void 0);return}try{l(ye(v,"resistance")),w(u,!1),o(l())}catch(t){console.log("Error",t),w(u,!0),console.log("Setting error flag"),l(t.message)}function n(t){if(t===void 0)return"";if(typeof t=="string")return w(u,!0),t;if(isNaN(t))return w(u,!0),"Not a number";if(t===0&&!h())return w(u,!0),"Zero not valid";if(!isFinite(t))return w(u,!0),"Infinity";let i=J(t);return w(u,!1),"["+i+_.unit+"]"}w(e,M(n(l())))}var it=D('<div class="frame svelte-zza4ss"><div class="input_div_with_columns svelte-zza4ss"><label class="svelte-zza4ss"> </label> <input type="text"> <label class="svelte-zza4ss"></label> <br class="svelte-zza4ss"> <div class="svelte-zza4ss"> </div></div></div>');function E(s,e){G(e,!0);let r=ue(e,"resultsSideDisplayValue",7),a=ue(e,"allowZeros",3,!1),l=W(!0),u=W(!1),o=W(""),h=W(M({}));Je(()=>{w(h,M(e.data[e.key]))});let _=Ge(()=>!!e.data[e.key].result);function v(d){console.log("Updating parent",e.cb),e.cb(e.key,d)}var n=it(),t=U(n),i=U(t),c=U(i,!0);L(i);var f=k(i,2);f.__input=[at,o,l,_,r,u,v,a,e],Q(()=>{var d;return $e(f,"placeholder",x(_)?"="+J(x(h).result)+e.unit:(d=x(h))==null?void 0:d.placeholder)});var y=k(f,2);Xe(y,21,()=>{var d;return(d=x(h))==null?void 0:d.extra},Ze,(d,T,N)=>{Be();var b=we();Q(()=>$(b,`${(N!=0?`
`:"")??""}
            ${J(x(T).val)??""}${x(T).unit??""}`)),O(d,b)}),L(y);var g=k(y,4),p=U(g,!0);L(g),L(t),L(n),Q(()=>{var d;$(c,(d=x(h))==null?void 0:d.name),f.readOnly=x(_),et(f,`${(x(_)?"showing_result":"")??""} svelte-zza4ss`),ce(f,"error",x(u)),ce(f,"emptyInput",x(l)),$(p,x(o))}),O(s,n),B()}Ye(["input"]);class re{constructor(e){this.data=e,this.input_vals={},this.results={},this.calculators={},this.extra_cb={}}register_input(e,r,a,l,u){this.data[e]={placeholder:r,extra:void 0,name:a,result:void 0},this.input_vals[e]=void 0,this.calculators[e]=l,this.extra_cb[e]=u}reset_results(){for(let e in this.input_vals)this.data[e].result=void 0,this.data[e].extra=void 0}_on_all_values_known(){for(let e in this.data)this.extra_cb[e]&&(this.data[e].extra=this.extra_cb[e](this.results))}_calculate_result_for(e){let r=this.calculators[e](this.input_vals);return this.results[e]=r,this.data[e].result=r,this._on_all_values_known(),r}on_change_callback(e,r){this.input_vals[e]=r,r&&(this.results[e]=r);let a=Object.keys(this.input_vals).filter(l=>this.input_vals[l]==null);a.length==1?this._calculate_result_for(a[0]):this.reset_results()}_reset_for_test(){for(let e in this.input_vals)this.data[e].result=void 0,this.data[e].extra=void 0,this.results[e]=void 0,this.input_vals[e]=void 0,this.data[e].extra=void 0,this.data[e].result=void 0}_test_input_field(e,r){this._reset_for_test();for(let o in e.values){if(o==r)continue;let h=e.values[o];this.on_change_callback(o,h)}function a(o,h){return(o==null||h==null)&&console.error("Got undefined: a=",o,"b=",h,Math.abs(o-h)),Math.abs(o-h)<1e-5}let l=e.values[r],u=this.results[r];if(!a(l,u))return console.error("Failed for ",r,u,"expected",l),!1;for(let o in e.values){let h=this.data[o].extra;if(h){if(!e.extras[o])return console.error("Could not find extra tester for",o),!1;e.extras[o].length!=h.length&&console.error("Different extra lenghts for test",o);for(let _=0;_<h.length;_++){if(!a(e.extras[o][_].val,h[_].val))return console.error("Extra VAL not correct for",o,JSON.stringify(this.data[o].extra),"expected",JSON.stringify(e.extras[o])),!1;if(e.extras[o][_].unit!=h[_].unit)return console.error("Extra UNIT not correct for",o,JSON.stringify(this.data[o].extra),"expected",JSON.stringify(e.extras[o])),!1}}}return!0}self_test(e){this.reset_results();for(let r in e.values)if(this._test_input_field(e,r)==!1)return console.error("Self test failed for field",r,JSON.stringify(e)),this._reset_for_test(),!1;return this._reset_for_test(),!0}}var lt=D("<!> <!> <!> <!>",1);function ut(s,e){G(e,!0);let r=M({}),a=new re(r);a.register_input("vin","V input","Vin",t=>t.vout*(t.rhigh+t.rlow)/t.rlow,t=>{let i=t.vin/(t.rhigh+t.rlow),c=i*t.vin;return[{val:i,unit:"A"},{val:c,unit:"W"}]}),a.register_input("rhigh","R Highside","Rhigh",t=>{let i=t.vout/t.rlow;return(t.vin-i*t.rlow)/i},t=>{let i=t.vin/(t.rhigh+t.rlow),c=i*i*t.rhigh;return[{val:t.vin-t.vout,unit:"V"},{val:c,unit:"W"}]}),a.register_input("rlow","10|4+2","R Lowside",t=>t.vout*t.rhigh/(t.vin-t.vout),t=>{let i=t.vin/(t.rhigh+t.rlow),c=i*i*t.rlow;return[{val:t.vout,unit:"V"},{val:c,unit:"W"}]}),a.register_input("vout","V output","Vout",t=>t.vin*t.rlow/(t.rhigh+t.rlow));function l(t,i,c){let f=t/(i+c),y=f*f*c,g=f*f*i,p=f*c,d={values:{},extras:{}};d.values.vin=t,d.values.rlow=c,d.values.rhigh=i,d.values.vout=p,d.extras.vin=[{val:f,unit:"A"},{val:y+g,unit:"W"}],d.extras.rhigh=[{val:t-p,unit:"V"},{val:g,unit:"W"}],d.extras.rlow=[{val:p,unit:"V"},{val:y,unit:"W"}],a.self_test(d)}l(1,2,3),l(3,2,2),l(100,3.3,2),l(101,2,3.3),l(102,3.3,3.3);function u(t,i){a.on_change_callback(t,i)}var o=lt(),h=Y(o);E(h,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"vin",unit:"V"});var _=k(h,2);E(_,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"rhigh",unit:"立"});var v=k(_,2);E(v,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"rlow",unit:"立"});var n=k(v,2);E(n,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"vout",unit:"V"}),O(s,o),B()}var ot=D("<!> <!> <!>",1);function ft(s,e){G(e,!0);let r=M({}),a=new re(r);a.register_input("voltage","V input","Vin",n=>n.current*n.resistance),a.register_input("current","Current","Current",n=>n.voltage/n.resistance),a.register_input("resistance","Resistance","",n=>n.voltage/n.current,n=>[{val:n.current*n.voltage,unit:"W"}]);function l(n,t){let i=n/t,c=n*i,f={values:{},extras:{}};f.values.voltage=n,f.values.current=i,f.values.resistance=t,f.extras.resistance=[{val:c,unit:"W"}],a.self_test(f)}l(1,2),l(3,2),l(100,3.3),l(101,2),l(102,3.3);function u(n,t){a.on_change_callback(n,t)}var o=ot(),h=Y(o);E(h,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"voltage",unit:"V"});var _=k(h,2);E(_,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"current",unit:"A"});var v=k(_,2);E(v,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"resistance",unit:"立"}),O(s,o),B()}var ct=D("<!> <!> <!>",1);function ht(s,e){G(e,!0);let r=M({}),a=new re(r);a.register_input("tc","Time Constant","Time",n=>n.capacitance*n.resistance,n=>[{val:1/(2*Math.PI*n.tc),unit:"Hz"}]),a.register_input("capacitance","Capacitance","Capacitance",n=>n.tc/n.resistance),a.register_input("resistance","Resistance","Resistance",n=>n.tc/n.capacitance);function l(n,t){let i=n*t,c=1/(2*Math.PI*i),f={values:{},extras:{}};f.values.capacitance=n,f.values.tc=i,f.values.resistance=t,f.extras={tc:[{val:c,unit:"Hz"}]},a.self_test(f)}l(1,2),l(3,2),l(100,3.3),l(101,2),l(102,3.3);function u(n,t){a.on_change_callback(n,t)}var o=ct(),h=Y(o);E(h,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"capacitance",unit:"F"});var _=k(h,2);E(_,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"resistance",unit:"立"});var v=k(_,2);E(v,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"tc",unit:"s"}),O(s,o),B()}var _t=D("<h1>OBS This is a draft...</h1> <h2>Voltage Divider</h2> <!> <h2>Ohms Law</h2> <!> <h2>RC</h2> <!>",1);function xt(s){var e=_t(),r=k(Y(e),4);ut(r,{});var a=k(r,4);ft(a,{});var l=k(a,4);ht(l,{}),O(s,e)}export{xt as component};
