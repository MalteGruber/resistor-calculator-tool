import{a as z,t as D,d as we}from"../chunks/disclose-version.I67LwOvb.js";import{W as me,w as Ee,A as m,_ as X,$ as Ne,i as Ae,ac as de,af as Re,ag as ne,a7 as K,C as L,ap as B,ah as ve,x as pe,ai as Te,e as ae,aq as Ie,ar as Me,as as Pe,v as ze,s as ie,at as Le,au as Ce,ab as Oe,av as Ve,z as Se,X as De,a8 as Fe,a2 as Ue,a5 as He,h as le,aw as Be,D as W,ao as U,I as Ge,O as Q,G as Y,c as w,d as b,q as We,Q as x,T as H,V as C,ax as Ye,F as Z}from"../chunks/runtime.-LiS_To0.js";import{p as ue,a as M}from"../chunks/props.C1vGAg5u.js";import{d as Ze,a as j}from"../chunks/store.DMN06xn4.js";let $=null;function qe(s,e){return e}function Je(s,e,r,a){for(var l=[],u=e.length,c=0;c<u;c++)Ce(e[c].e,l,!0);var h=u>0&&l.length===0&&r!==null;if(h){var _=r.parentNode;Oe(_),_.append(r),a.clear(),A(s,e[0].prev,e[u-1].next)}Ve(l,()=>{for(var d=0;d<u;d++){var n=e[d];h||(a.delete(n.k),A(s,n.prev,n.next)),Se(n.e,!h)}})}function Xe(s,e,r,a,l,u=null){var c=s,h={flags:e,items:new Map,first:null};{var _=s;c=m?X(De(_)):_.appendChild(me())}m&&Ne();var d=null,n=!1;Ee(()=>{var t=r(),i=Ae(t)?t:t==null?[]:de(t),o=i.length;if(n&&o===0)return;n=o===0;let f=!1;if(m){var k=c.data===Re;k!==(o===0)&&(c=ne(),X(c),K(!1),f=!0)}if(m){for(var g=null,p,v=0;v<o;v++){if(L.nodeType===8&&L.data===Fe){c=L,f=!0,K(!1);break}var R=i[v],N=a(R,v);p=ge(L,h,g,null,R,N,v,l,e),h.items.set(N,p),g=p}o>0&&X(ne())}if(!m){var y=Ue;Ke(i,h,c,l,e,(y.f&B)!==0,a)}u!==null&&(o===0?d?ve(d):d=pe(()=>u(c)):d!==null&&Te(d,()=>{d=null})),f&&K(!0),r()}),m&&(c=L)}function Ke(s,e,r,a,l,u,c){var h=s.length,_=e.items,d=e.first,n=d,t,i=null,o=[],f=[],k,g,p,v;for(v=0;v<h;v+=1){if(k=s[v],g=c(k,v),p=_.get(g),p===void 0){var R=n?n.e.nodes_start:r;i=ge(R,e,i,i===null?e.first:i.next,k,g,v,a,l),_.set(g,i),o=[],f=[],n=i.next;continue}if(Qe(p,k,v),p.e.f&B&&ve(p.e),p!==n){if(t!==void 0&&t.has(p)){if(o.length<f.length){var N=f[0],y;i=N.prev;var se=o[0],q=o[o.length-1];for(y=0;y<o.length;y+=1)oe(o[y],N,r);for(y=0;y<f.length;y+=1)t.delete(f[y]);A(e,se.prev,q.next),A(e,i,se),A(e,q,N),n=N,i=q,v-=1,o=[],f=[]}else t.delete(p),oe(p,n,r),A(e,p.prev,p.next),A(e,p,i===null?e.first:i.next),A(e,i,p),i=p;continue}for(o=[],f=[];n!==null&&n.k!==g;)(u||!(n.e.f&B))&&(t??(t=new Set)).add(n),f.push(n),n=n.next;if(n===null)continue;p=n}o.push(p),i=p,n=p.next}if(n!==null||t!==void 0){for(var J=t===void 0?[]:de(t);n!==null;)(u||!(n.e.f&B))&&J.push(n),n=n.next;var xe=J.length;if(xe>0){var ke=h===0?r:null;Je(e,J,ke,_)}}ae.first=e.first&&e.first.e,ae.last=i&&i.e}function Qe(s,e,r,a){Ie(s.v,e),s.i=r}function ge(s,e,r,a,l,u,c,h,_){var d=$;try{var n=(_&Me)!==0,t=(_&Pe)===0,i=n?t?ze(l):ie(l):l,o=_&Le?ie(c):c,f={i:o,v:i,k:u,a:null,e:null,prev:r,next:a};return $=f,f.e=pe(()=>h(s,i,o),m),f.e.prev=r&&r.e,f.e.next=a&&a.e,r===null?e.first=f:(r.next=f,r.e.next=f.e),a!==null&&(a.prev=f,a.e.prev=f.e),f}finally{$=d}}function oe(s,e,r){for(var a=s.next?s.next.e.nodes_start:r,l=e?e.e.nodes_start:r,u=s.e.nodes_start;u!==a;){var c=He(u);l.before(u),u=c}}function A(s,e,r){e===null?s.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function je(s,e,r,a){var l=s.__attributes??(s.__attributes={});m&&(l[e]=s.getAttribute(e)),l[e]!==(l[e]=r)&&(r==null?s.removeAttribute(e):typeof r!="string"&&$e(s).includes(e)?s[e]=r:s.setAttribute(e,r))}var ce=new Map;function $e(s){var e=ce.get(s.nodeName);if(e)return e;ce.set(s.nodeName,e=[]);for(var r,a=le(s),l=Element.prototype;l!==a;){r=Be(a);for(var u in r)r[u].set&&e.push(u);a=le(a)}return e}function et(s,e){var r=s.__className,a=tt(e);m&&s.className===a?s.__className=a:(r!==a||m&&s.className!==a)&&(e==null?s.removeAttribute("class"):s.className=a,s.__className=a)}function tt(s){return s??""}function fe(s,e,r){if(r){if(s.classList.contains(e))return;s.classList.add(e)}else{if(!s.classList.contains(e))return;s.classList.remove(e)}}const te="LPAREN",be="RPAREN",O="PLUS",P="PARALLEL",T="NUMBER",V="TIMES",S="DIVIDE",rt="DONE";class st{get_next_token(){return this.tokens.shift()}constructor(e){this.tokens=e,this.current_token=this.get_next_token()}error(){console.error("Parsing errror",this.current_token)}eat(e){this.current_token.type==e?this.current_token=this.get_next_token():this.error()}factor(){let e=this.current_token;if(e.type==T)return this.eat(T),e;if(e.type==te){this.eat(te);let r=this.expr();return this.eat(be),r}}term(){let e=this.factor();for(;[P,V,S].includes(this.current_token.type);){let r=this.current_token;r.type==P?this.eat(P):r.type==V?this.eat(V):r.type==S&&this.eat(S),e={left:e,op:r,right:this.factor()}}return e}expr(){let e=this.term();for(;[O].includes(this.current_token.type);){let r=this.current_token;r.type==O&&this.eat(O),e={left:e,op:r,right:this.term()}}return e}parse(){return this.expr()}}function he(s,e){return 1/(1/s+1/e)}const I=[{value:1e-15,symbol:"f",name:"Femto"},{value:1e-12,symbol:"p",name:"Pico"},{value:1e-9,symbol:"n",name:"Nano"},{value:1e-6,symbol:"u",name:"Micro"},{value:.001,symbol:"m",name:"Milli"},{value:1,symbol:"",name:""},{value:1e3,symbol:"k",name:"Kilo"},{value:1e6,symbol:"M",name:"Mega"},{value:1e9,symbol:"G",name:"Giga"},{value:1e12,symbol:"T",name:"Tera"}];function ee(s){let e=parseFloat(s),r="eE";if(r.includes(s))throw new Error("Missing Base");if(r.includes(s.charAt(s.length-1)))throw new Error("Missing Exponent");return I.forEach(a=>{s.charAt(s.length-1).includes(a.symbol)&&(e*=a.value)}),e}function ye(s,e="resistance"){if(s=s+"",s=="")return;let r=[];function a(t){let i;if([["|",P],["(",te],[")",be],["+",O],["*",V],["/",S]].forEach(f=>{f[0]===t&&(i=f[1])}),i===void 0)throw new Error('"'+t+'" not valid');return i}let l=!1,u="",c="0123456789.-";c+="eE",I.forEach(t=>{c+=t.symbol});for(let t in s){let i=s[t];if(i===" ")continue;let o=c.includes(i);o&&(u+=i),l=u.length>0,!o&&l?(r.push({token:u,type:T}),u="",l=!1,r.push({token:i,type:a(i)})):o||r.push({token:i,type:a(i)})}if(l&&r.push({token:u,type:T}),r.push({type:rt}),r.length==2&&r[0].type==T)return ee(r[0].token);let _=new st(r).parse();function d(t){let i;if(t.left===void 0||t.right===void 0)throw new Error("Incomplete expression");t.left.type==T?i=ee(t.left.token):i=d(t.left);let o;if(t.right.type==T?o=ee(t.right.token):o=d(t.right),t.op.type==P)return e==="resistance"?he(i,o):i+o;if(t.op.type==O)return e==="resistance"?i+o:he(i,o);if(t.op.type==V)return i*o;if(t.op.type==S)return i/o;console.info("You should not be here!",t.op.type,t.op.type==P)}let n="Parsing Error";try{n=d(_)}catch(t){return console.error("PARSING ERROR"),console.log(t),console.log(JSON.stringify(_)),"Parsing error: "+t.message}return n}let nt=[{exp:"(1+1)",assert:2},{exp:"(100+100+100)",assert:300},{exp:"1",assert:1},{exp:"1|1",assert:.5},{exp:"1|1|1|1",assert:.25},{exp:"1|1|1|1+1",assert:1.25},{exp:"1|1|(0.5+1|1)|1+1",assert:1.25},{exp:"1k*2k",assert:1e3*2e3},{exp:"3*7k+1",assert:3*7e3+1},{exp:"2+3*7k+1",assert:2+3*7e3+1},{exp:"2+3*7k+1|1",assert:2+3*7e3+.5},{exp:"(1|1)",assert:.5},{exp:"(1|1)*2",assert:1},{exp:"2*(1|1)",assert:1},{exp:"1+2*(1|1)",assert:2},{exp:"10+2*2+(1|1)",assert:10+2*2+.5},{exp:"7*3",assert:7*3},{exp:"7*3/2",assert:7*3/2},{exp:"7/11*3/2",assert:7/11*3/2},{exp:"7/11*3/2+1",assert:7/11*3/2+1},{exp:"(7/11*3/2+1)/5",assert:(7/11*3/2+1)/5}],F=!0;nt.forEach(s=>{let e=ye(s.exp);e!=s.assert&&(console.error("Test failed!!"),console.log("Test:",JSON.stringify(s),"Result:",e,"Expected",s.assert),F=!1)});F&&console.log("All tests passed!");function G(s){if(isNaN(s))return console.log("Not a number"),s;if(!isFinite(s))return console.log("Infinite number"),s;let e=!1,r=I[0];if(!(s<r.value))for(let l=0;l<I.length;l++){let u=I[l];if(l==I.length-1)break;let c=I[l+1].value;s<c&&!e&&(r=u,e=!0)}let a=s;if(e){a=s/r.value;let l=1e3;return a=Math.round(a*l)/l,a+""+r.symbol}else return parseFloat(a).toPrecision(3)}let _e=[{n:1,assert:"1"},{n:1e3,assert:"1k"},{n:1e6,assert:"1M"},{n:1e9,assert:"1G"},{n:1e12,assert:"1.00e+12"},{n:1e15,assert:"1.00e+15"},{n:13123123123123122e-1,assert:"1.31e+15"},{n:0x4f9494ccaafb3,assert:"1.40e+15"},{n:1/3,assert:"333.333m"},{n:.001,assert:"1m"},{n:1e-6,assert:"1u"},{n:1e-9,assert:"1n"},{n:1e-12,assert:"1p"},{n:1e-15,assert:"1f"},{n:1e-18,assert:"1.00e-18"},{n:1001,assert:"1.001k"},{n:.001,assert:"1m"},{n:1e-6,assert:"1u"},{n:1e-9,assert:"1n"},{n:1e-12,assert:"1p"},{n:1e-15,assert:"1f"},{n:1e-18,assert:"1.00e-18"},{n:13123123123123122e-31,assert:"1.312f"},{n:13999931231231231e-31,assert:"1.4f"},{n:.001/3,assert:"333.333u"}];F=!0;for(let s=0;s<_e.length;s++){let e=_e[s],r=G(e.n);if(r!=e.assert){console.error("Test failed!!"),console.log("Test:",e,"Result:",r,"Expected",e.assert),F=!1;break}}F?console.log("All stringify tests passed!"):console.error("Test failed");function at(s,e,r,a,l,u,c,h,_){w(e,"");let d=s.target.value;if(w(r,M((d===""||d===void 0)&&!b(a))),b(r)){l(void 0),w(u,!1),c(void 0);return}try{l(ye(d,"resistance")),w(u,!1),c(l())}catch(t){console.log("Error",t),w(u,!0),console.log("Setting error flag"),l(t.message)}function n(t){if(t===void 0)return"";if(typeof t=="string")return w(u,!0),t;if(isNaN(t))return w(u,!0),"Not a number";if(t===0&&!h())return w(u,!0),"Zero not valid";if(!isFinite(t))return w(u,!0),"Infinity";let i=G(t);return w(u,!1),"["+i+_.unit+"]"}w(e,M(n(l())))}var it=D('<div class="frame svelte-zza4ss"><div class="input_div_with_columns svelte-zza4ss"><label class="svelte-zza4ss"> </label> <input type="text"> <label class="svelte-zza4ss"></label> <br class="svelte-zza4ss"> <div class="svelte-zza4ss"> </div></div></div>');function E(s,e){W(e,!0);let r=ue(e,"resultsSideDisplayValue",7),a=ue(e,"allowZeros",3,!1),l=U(!0),u=U(!1),c=U(""),h=U(M({}));Ge(()=>{w(h,M(e.data[e.key]))});let _=We(()=>!!e.data[e.key].result);function d(v){console.log("Updating parent",e.cb),e.cb(e.key,v)}var n=it(),t=H(n),i=H(t),o=H(i,!0);C(i);var f=x(i,2);f.__input=[at,c,l,_,r,u,d,a,e],Q(()=>{var v;return je(f,"placeholder",b(_)?"="+G(b(h).result)+e.unit:(v=b(h))==null?void 0:v.placeholder)});var k=x(f,2);Xe(k,21,()=>{var v;return(v=b(h))==null?void 0:v.extra},qe,(v,R,N)=>{Ye();var y=we();Q(()=>j(y,`${(N!=0?`
`:"")??""}
            ${G(b(R).val)??""}${b(R).unit??""}`)),z(v,y)}),C(k);var g=x(k,4),p=H(g,!0);C(g),C(t),C(n),Q(()=>{var v;j(o,(v=b(h))==null?void 0:v.name),f.readOnly=b(_),et(f,`${(b(_)?"showing_result":"")??""} svelte-zza4ss`),fe(f,"error",b(u)),fe(f,"emptyInput",b(l)),j(p,b(c))}),z(s,n),Y()}Ze(["input"]);class re{constructor(e){this.data=e,this.input_vals={},this.results={},this.calculators={},this.extra_cb={}}register_input(e,r,a,l,u){this.data[e]={placeholder:r,extra:void 0,name:a,result:void 0},this.input_vals[e]=void 0,this.calculators[e]=l,this.extra_cb[e]=u}reset_results(){for(let e in this.input_vals)this.data[e].result=void 0,this.data[e].extra=void 0}_on_all_values_known(){for(let e in this.data)this.extra_cb[e]&&(this.data[e].extra=this.extra_cb[e](this.results))}_calculate_result_for(e){let r=this.calculators[e](this.input_vals);return this.results[e]=r,this.data[e].result=r,this._on_all_values_known(),r}on_change_callback(e,r){this.input_vals[e]=r,r&&(this.results[e]=r);let a=Object.keys(this.input_vals).filter(l=>this.input_vals[l]==null);a.length==1?this._calculate_result_for(a[0]):this.reset_results()}_reset_for_test(){for(let e in this.input_vals)this.data[e].result=void 0,this.data[e].extra=void 0,this.results[e]=void 0,this.input_vals[e]=void 0,this.data[e].extra=void 0,this.data[e].result=void 0}_test_input_field(e,r){this._reset_for_test();for(let c in e.values){if(c==r)continue;let h=e.values[c];this.on_change_callback(c,h)}function a(c,h){return Math.abs(c-h)<1e-7}let l=e.values[r],u=this.results[r];return a(l,u)?!0:(console.log("Failed for ",r,u,"expected",l),console.log(this.results),!1)}self_test(e){this.reset_results();for(let r in e.values)if(this._test_input_field(e,r)==!1)return console.error("Self test failed for field",r,e),this._reset_for_test(),!1;return this._reset_for_test(),!0}}var lt=D("<!> <!> <!> <!>",1);function ut(s,e){W(e,!0);let r=M({}),a=new re(r);a.register_input("vin","V input","Vin",t=>t.vout*(t.rhigh+t.rlow)/t.rlow,t=>{let i=t.vout/(t.rhigh+t.rlow),o=i*i*t.rhigh;return[{val:i,unit:"A"},{val:o,unit:"W"}]}),a.register_input("rhigh","R Highside","Rhigh",t=>{let i=t.vout/t.rlow;return(t.vin-i*t.rlow)/i},t=>{let i=t.vout/(t.rhigh+t.rlow),o=i*i*t.rhigh;return[{val:t.vin-t.vout,unit:"V"},{val:o,unit:"W"}]}),a.register_input("rlow","10|4+2","R Lowside",t=>t.vout*t.rhigh/(t.vin-t.vout),t=>{let i=t.vout/(t.rhigh+t.rlow),o=i*i*t.rlow;return[{val:t.vout,unit:"V"},{val:o,unit:"W"}]}),a.register_input("vout","V output","Vout",t=>t.vin*t.rlow/(t.rhigh+t.rlow));function l(t,i,o){let k=t/(i+o)*o,g={values:{},extras:{}};g.values.vin=t,g.values.rlow=o,g.values.rhigh=i,g.values.vout=k,a.self_test(g)}l(1,2,3),l(3,2,2),l(100,3.3,2),l(101,2,3.3),l(102,3.3,3.3);function u(t,i){a.on_change_callback(t,i)}var c=lt(),h=Z(c);E(h,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"vin",unit:"V"});var _=x(h,2);E(_,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"rhigh",unit:"立"});var d=x(_,2);E(d,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"rlow",unit:"立"});var n=x(d,2);E(n,{get cb(){return u},set cb(t){u=t},get data(){return a.data},key:"vout",unit:"V"}),z(s,c),Y()}var ot=D("<!> <!> <!>",1);function ct(s,e){W(e,!0);let r=M({}),a=new re(r);a.register_input("voltage","V input","Vin",n=>n.current*n.resistance),a.register_input("current","Current","Current",n=>n.voltage/n.resistance),a.register_input("resistance","Resistance","",n=>n.voltage/n.current,n=>[{val:n.current*n.current,unit:"W"}]);function l(n,t){let i=n/t,o={values:{},extras:{}};o.values.voltage=n,o.values.current=i+1,o.values.resistance=t,a.self_test(o)}l(1,2),l(3,2),l(100,3.3),l(101,2),l(102,3.3);function u(n,t){a.on_change_callback(n,t)}var c=ot(),h=Z(c);E(h,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"voltage",unit:"V"});var _=x(h,2);E(_,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"current",unit:"A"});var d=x(_,2);E(d,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"resistance",unit:"立"}),z(s,c),Y()}var ft=D("<!> <!> <!>",1);function ht(s,e){W(e,!0);let r=M({}),a=new re(r);a.register_input("tc","Time Constant","Time",n=>n.capacitance*n.resistance,n=>[{val:1/(2*Math.PI*n.tc),unit:"Hz"}]),a.register_input("capacitance","Capacitance","Capacitance",n=>n.tc/n.resistance),a.register_input("resistance","Resistance","Resistance",n=>n.tc/n.capacitance);function l(n,t){let i=n*t,o={values:{},extras:{}};o.values.capacitance=n,o.values.tc=i,o.values.resistance=t,a.self_test(o)}l(1,2),l(3,2),l(100,3.3),l(101,2),l(102,3.3);function u(n,t){a.on_change_callback(n,t)}var c=ft(),h=Z(c);E(h,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"capacitance",unit:"F"});var _=x(h,2);E(_,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"resistance",unit:"立"});var d=x(_,2);E(d,{get cb(){return u},set cb(n){u=n},get data(){return a.data},key:"tc",unit:"s"}),z(s,c),Y()}var _t=D("<h1>OBS This is a draft...</h1> <h2>Voltage Divider</h2> <!> <h2>Ohms Law</h2> <!> <h2>RC</h2> <!>",1);function bt(s){var e=_t(),r=x(Z(e),4);ut(r,{});var a=x(r,4);ct(a,{});var l=x(a,4);ht(l,{}),z(s,e)}export{bt as component};
